ASC by ASC1-ASC5;
OSC by OSC1-OSC6;
SCO by ASC@0.8 OSC@0.8;
UC by UC1-UC3;
UC@1;
DC by DC1-DC3;
DC@1;
SCOUC | SCO XWITH UC;
SCODC | SCO XWITH DC;
RD by RD1-RD5;
POS by POS1-POS5;
LS by LS1-LS5;
RD on SCO(a1)
UC
SCOUC(w1);
POS on SCO(a2)
DC
SCODC(w2);
LS on SCO(c)
RD(b1)
POS(b2);
",
MODELCONSTRAINT = "
NEW(L_SCS M_SCS H_SCS
IE_L_RD IE_M_RD IE_H_RD
IE_L_POS IE_M_POS IE_H_POS
DIF_LM_RD DIF_LH_RD DIF_MH_RD
DIF_LM_POS DIF_LH_POS DIF_MH_POS
);
L_SCS = -1;
M_SCS = 0;
H_SCS = 1;
IE_L_RD = (a1+w1*L_SCS)*b1;
IE_M_RD = (a1+w1*M_SCS)*b1;
IE_H_RD = (a1+w1*H_SCS)*b1;
IE_L_POS = (a2+w2*L_SCS)*b2;
IE_M_POS = (a2+w2*M_SCS)*b2;
IE_H_POS = (a2+w2*H_SCS)*b2;
DIF_LM_RD = IE_L_RD - IE_M_RD;
DIF_LH_RD = IE_L_RD - IE_H_RD;
DIF_MH_RD = IE_M_RD - IE_H_RD;
DIF_LM_POS = IE_L_POS - IE_M_POS;
DIF_LH_POS = IE_L_POS - IE_H_POS;
DIF_MH_POS = IE_M_POS - IE_H_POS;
PLOT(P_L_RD P_M_RD P_H_RD
P_L_POS P_M_POS P_H_POS);
LOOP(XVAL,1,7,0.1);
P_L_RD = IE_L_RD*XVAL;
P_M_RD = IE_M_RD*XVAL;
P_H_RD = IE_H_RD*XVAL;
P_L_POS = IE_L_POS*XVAL;
P_M_POS = IE_M_POS*XVAL;
P_H_POS = IE_H_POS*XVAL;
",
PLOT = "
TYPE = plot2;
",
OUTPUT = "
cint;
STDYX",
rdata = df.raw)
mplusModeler(SEM.mod.SCS, modelout = "./OUTPUT/Mplus/SEM.mod.SCS.inp", run = 1L)
SEM.mod.SCS <- mplusObject(
TITLE = "
Moderator is SCS(UC DC);
",
ANALYSIS = "
TYPE =general RANDOM;
estimator=MLR;
ALGORITHM=INTEGRATION;
convergence=0.01;
process=16;
",
MODEL = "
ASC by ASC1-ASC5;
OSC by OSC1-OSC6;
SCO by ASC@0.8 OSC@0.8;
UC by UC1-UC3;
UC@1;
DC by DC1-DC3;
DC@1;
SCOUC | SCO XWITH UC;
SCODC | SCO XWITH DC;
RD by RD1-RD5;
POS by POS1-POS5;
LS by LS1-LS5;
RD on SCO(a1)
UC
SCOUC(w1);
POS on SCO(a2)
DC
SCODC(w2);
LS on SCO(c)
RD(b1)
POS(b2);
",
MODELCONSTRAINT = "
NEW(L_SCS M_SCS H_SCS
IE_L_RD IE_M_RD IE_H_RD
IE_L_POS IE_M_POS IE_H_POS
DIF_LM_RD DIF_LH_RD DIF_MH_RD
DIF_LM_POS DIF_LH_POS DIF_MH_POS
);
L_SCS = -1;
M_SCS = 0;
H_SCS = 1;
IE_L_RD = (a1+w1*L_SCS)*b1;
IE_M_RD = (a1+w1*M_SCS)*b1;
IE_H_RD = (a1+w1*H_SCS)*b1;
IE_L_POS = (a2+w2*L_SCS)*b2;
IE_M_POS = (a2+w2*M_SCS)*b2;
IE_H_POS = (a2+w2*H_SCS)*b2;
DIF_LM_RD = IE_L_RD - IE_M_RD;
DIF_LH_RD = IE_L_RD - IE_H_RD;
DIF_MH_RD = IE_M_RD - IE_H_RD;
DIF_LM_POS = IE_L_POS - IE_M_POS;
DIF_LH_POS = IE_L_POS - IE_H_POS;
DIF_MH_POS = IE_M_POS - IE_H_POS;
PLOT(P_L_RD P_M_RD P_H_RD
P_L_POS P_M_POS P_H_POS);
LOOP(XVAL,1,7,0.1);
P_L_RD = IE_L_RD*XVAL;
P_M_RD = IE_M_RD*XVAL;
P_H_RD = IE_H_RD*XVAL;
P_L_POS = IE_L_POS*XVAL;
P_M_POS = IE_M_POS*XVAL;
P_H_POS = IE_H_POS*XVAL;
",
PLOT = "
TYPE = plot2;
",
OUTPUT = "
cint;
STDYX",
rdata = df.raw)
mplusModeler(SEM.mod.SCS, modelout = "./OUTPUT/Mplus/SEM.mod.SCS.inp", run = 1L)
rm(SEM.mod.SCS)
SEM.mod.USC_DSC <- mplusObject(
TITLE = "
Moderator is USC DSC;
",
ANALYSIS = "
TYPE =general RANDOM;
estimator=MLR;
ALGORITHM=INTEGRATION;
convergence=0.01;
",
MODEL = "
ASC by ASC1-ASC5;
OSC by OSC1-OSC6;
SCO by ASC@0.8 OSC@0.8;
USC@1;
DSC@1;
SCOU | SCO XWITH USC;
SCOD | SCO XWITH DSC;
RD by RD1-RD5;
POS by POS1-POS5;
LS by LS1-LS5;
RD on SCO(a1)
USC
SCOU(w1);
POS on SCO(a2)
DSC
SCOD(w2);
LS on SCO(c)
RD(b1)
POS(b2);
",
MODELCONSTRAINT = "
NEW(L_SCD M_SCD H_SCD
IE_L_RD IE_M_RD IE_H_RD
IE_L_POS IE_M_POS IE_H_POS
DIF_LM_RD DIF_LH_RD DIF_MH_RD
DIF_LM_POS DIF_LH_POS DIF_MH_POS
);
L_UDSC = -1;
M_UDSC = 0;
H_UDSC = 1;
IE_L_RD = (a1+w1*L_UDSC)*b1;
IE_M_RD = (a1+w1*M_UDSC)*b1;
IE_H_RD = (a1+w1*H_UDSC)*b1;
IE_L_POS = (a2+w2*L_UDSC)*b2;
IE_M_POS = (a2+w2*M_UDSC)*b2;
IE_H_POS = (a2+w2*H_UDSC)*b2;
DIF_LM_RD = IE_L_RD - IE_M_RD;
DIF_LH_RD = IE_L_RD - IE_H_RD;
DIF_MH_RD = IE_M_RD - IE_H_RD;
DIF_LM_POS = IE_L_POS - IE_M_POS;
DIF_LH_POS = IE_L_POS - IE_H_POS;
DIF_MH_POS = IE_M_POS - IE_H_POS;
PLOT(P_L_RD P_M_RD P_H_RD
P_L_POS P_M_POS P_H_POS);
LOOP(XVAL,1,7,0.1);
P_L_RD = IE_L_RD*XVAL;
P_M_RD = IE_M_RD*XVAL;
P_H_RD = IE_H_RD*XVAL;
P_L_POS = IE_L_POS*XVAL;
P_M_POS = IE_M_POS*XVAL;
P_H_POS = IE_H_POS*XVAL;
",
PLOT = "
TYPE = plot2;
",
OUTPUT = "
cint;
STDYX",
rdata = df.raw)
mplusModeler(SEM.mod.USC_DSC, modelout = "./OUTPUT/Mplus/SEM.mod.USC_DSC.inp", run = 1L)
rm(SEM.mod.USC_DSC)
SEM.mod.USC_DSC <- mplusObject(
TITLE = "
Moderator is USC DSC;
",
ANALYSIS = "
TYPE =general RANDOM;
estimator=MLR;
ALGORITHM=INTEGRATION;
convergence=0.01;
",
MODEL = "
ASC by ASC1-ASC5;
OSC by OSC1-OSC6;
SCO by ASC@0.8 OSC@0.8;
USC@1;
DSC@1;
SCOU | SCO XWITH USC;
SCOD | SCO XWITH DSC;
RD by RD1-RD5;
POS by POS1-POS5;
LS by LS1-LS5;
RD on SCO(a1)
USC
SCOU(w1);
POS on SCO(a2)
DSC
SCOD(w2);
LS on SCO(c)
RD(b1)
POS(b2);
",
MODELCONSTRAINT = "
NEW(L_UDSC M_UDSC H_UDSC
IE_L_RD IE_M_RD IE_H_RD
IE_L_POS IE_M_POS IE_H_POS
DIF_LM_RD DIF_LH_RD DIF_MH_RD
DIF_LM_POS DIF_LH_POS DIF_MH_POS
);
L_UDSC = -1;
M_UDSC = 0;
H_UDSC = 1;
IE_L_RD = (a1+w1*L_UDSC)*b1;
IE_M_RD = (a1+w1*M_UDSC)*b1;
IE_H_RD = (a1+w1*H_UDSC)*b1;
IE_L_POS = (a2+w2*L_UDSC)*b2;
IE_M_POS = (a2+w2*M_UDSC)*b2;
IE_H_POS = (a2+w2*H_UDSC)*b2;
DIF_LM_RD = IE_L_RD - IE_M_RD;
DIF_LH_RD = IE_L_RD - IE_H_RD;
DIF_MH_RD = IE_M_RD - IE_H_RD;
DIF_LM_POS = IE_L_POS - IE_M_POS;
DIF_LH_POS = IE_L_POS - IE_H_POS;
DIF_MH_POS = IE_M_POS - IE_H_POS;
PLOT(P_L_RD P_M_RD P_H_RD
P_L_POS P_M_POS P_H_POS);
LOOP(XVAL,1,7,0.1);
P_L_RD = IE_L_RD*XVAL;
P_M_RD = IE_M_RD*XVAL;
P_H_RD = IE_H_RD*XVAL;
P_L_POS = IE_L_POS*XVAL;
P_M_POS = IE_M_POS*XVAL;
P_H_POS = IE_H_POS*XVAL;
",
PLOT = "
TYPE = plot2;
",
OUTPUT = "
cint;
STDYX",
rdata = df.raw)
mplusModeler(SEM.mod.USC_DSC, modelout = "./OUTPUT/Mplus/SEM.mod.USC_DSC.inp", run = 1L)
rm(SEM.mod.USC_DSC)
SEM.mod.SCD <- capture.output({mplusObject(
TITLE = "
Moderator is SCD;
",
ANALYSIS = "
TYPE =general RANDOM;
estimator=MLR;
ALGORITHM=INTEGRATION;
convergence=0.01;
",
MODEL = "
ASC by ASC1-ASC5;
OSC by OSC1-OSC6;
SCO by ASC@0.8 OSC@0.8;
SCD@1;
OD | SCO XWITH SCD;
RD by RD1-RD5;
POS by POS1-POS5;
LS by LS1-LS5;
RD on SCO(a1)
SCD
OD(w1);
POS on SCO(a2)
SCD
OD(w2);
LS on SCO(c)
RD(b1)
POS(b2);
",
MODELCONSTRAINT = "
NEW(L_SCD M_SCD H_SCD
IE_L_RD IE_M_RD IE_H_RD
IE_L_POS IE_M_POS IE_H_POS
DIF_LM_RD DIF_LH_RD DIF_MH_RD
DIF_LM_POS DIF_LH_POS DIF_MH_POS
);
L_SCD = -1;
M_SCD = 0;
H_SCD = 1;
IE_L_RD = (a1+w1*L_SCD)*b1;
IE_M_RD = (a1+w1*M_SCD)*b1;
IE_H_RD = (a1+w1*H_SCD)*b1;
IE_L_POS = (a2+w2*L_SCD)*b2;
IE_M_POS = (a2+w2*M_SCD)*b2;
IE_H_POS = (a2+w2*H_SCD)*b2;
DIF_LM_RD = IE_L_RD - IE_M_RD;
DIF_LH_RD = IE_L_RD - IE_H_RD;
DIF_MH_RD = IE_M_RD - IE_H_RD;
DIF_LM_POS = IE_L_POS - IE_M_POS;
DIF_LH_POS = IE_L_POS - IE_H_POS;
DIF_MH_POS = IE_M_POS - IE_H_POS;
PLOT(P_L_RD P_M_RD P_H_RD
P_L_POS P_M_POS P_H_POS);
LOOP(XVAL,1,7,0.1);
P_L_RD = IE_L_RD*XVAL;
P_M_RD = IE_M_RD*XVAL;
P_H_RD = IE_H_RD*XVAL;
P_L_POS = IE_L_POS*XVAL;
P_M_POS = IE_M_POS*XVAL;
P_H_POS = IE_H_POS*XVAL;
",
PLOT = "
TYPE = plot2;
",
OUTPUT = "
cint;
STDYX",
rdata = df.raw)
})
writeLines(SEM.mod.SCD, "./OUTPUT/SEM/SEM.mod.SCD")
mplusModeler(SEM.mod.SCD, modelout = "./OUTPUT/Mplus/SEM.mod.SCD.inp", run = 1L)
SEM.mod.SCD <- capture.output({mplusObject(
TITLE = "
Moderator is SCD;
",
ANALYSIS = "
TYPE =general RANDOM;
estimator=MLR;
ALGORITHM=INTEGRATION;
convergence=0.01;
",
MODEL = "
ASC by ASC1-ASC5;
OSC by OSC1-OSC6;
SCO by ASC@0.8 OSC@0.8;
SCD@1;
OD | SCO XWITH SCD;
RD by RD1-RD5;
POS by POS1-POS5;
LS by LS1-LS5;
RD on SCO(a1)
SCD
OD(w1);
POS on SCO(a2)
SCD
OD(w2);
LS on SCO(c)
RD(b1)
POS(b2);
",
MODELCONSTRAINT = "
NEW(L_SCD M_SCD H_SCD
IE_L_RD IE_M_RD IE_H_RD
IE_L_POS IE_M_POS IE_H_POS
DIF_LM_RD DIF_LH_RD DIF_MH_RD
DIF_LM_POS DIF_LH_POS DIF_MH_POS
);
L_SCD = -1;
M_SCD = 0;
H_SCD = 1;
IE_L_RD = (a1+w1*L_SCD)*b1;
IE_M_RD = (a1+w1*M_SCD)*b1;
IE_H_RD = (a1+w1*H_SCD)*b1;
IE_L_POS = (a2+w2*L_SCD)*b2;
IE_M_POS = (a2+w2*M_SCD)*b2;
IE_H_POS = (a2+w2*H_SCD)*b2;
DIF_LM_RD = IE_L_RD - IE_M_RD;
DIF_LH_RD = IE_L_RD - IE_H_RD;
DIF_MH_RD = IE_M_RD - IE_H_RD;
DIF_LM_POS = IE_L_POS - IE_M_POS;
DIF_LH_POS = IE_L_POS - IE_H_POS;
DIF_MH_POS = IE_M_POS - IE_H_POS;
PLOT(P_L_RD P_M_RD P_H_RD
P_L_POS P_M_POS P_H_POS);
LOOP(XVAL,1,7,0.1);
P_L_RD = IE_L_RD*XVAL;
P_M_RD = IE_M_RD*XVAL;
P_H_RD = IE_H_RD*XVAL;
P_L_POS = IE_L_POS*XVAL;
P_M_POS = IE_M_POS*XVAL;
P_H_POS = IE_H_POS*XVAL;
",
PLOT = "
TYPE = plot2;
",
OUTPUT = "
cint;
STDYX",
rdata = df.raw)
})
writeLines(SEM.mod.SCD, "./OUTPUT/SEM/SEM.mod.SCD.md")
mplusModeler(SEM.mod.SCD, modelout = "./OUTPUT/Mplus/SEM.mod.SCD.inp", run = 1L)
SEM.mod.SCD <- mplusObject(
TITLE = "
Moderator is SCD;
",
ANALYSIS = "
TYPE =general RANDOM;
estimator=MLR;
ALGORITHM=INTEGRATION;
convergence=0.01;
",
MODEL = "
ASC by ASC1-ASC5;
OSC by OSC1-OSC6;
SCO by ASC@0.8 OSC@0.8;
SCD@1;
OD | SCO XWITH SCD;
RD by RD1-RD5;
POS by POS1-POS5;
LS by LS1-LS5;
RD on SCO(a1)
SCD
OD(w1);
POS on SCO(a2)
SCD
OD(w2);
LS on SCO(c)
RD(b1)
POS(b2);
",
MODELCONSTRAINT = "
NEW(L_SCD M_SCD H_SCD
IE_L_RD IE_M_RD IE_H_RD
IE_L_POS IE_M_POS IE_H_POS
DIF_LM_RD DIF_LH_RD DIF_MH_RD
DIF_LM_POS DIF_LH_POS DIF_MH_POS
);
L_SCD = -1;
M_SCD = 0;
H_SCD = 1;
IE_L_RD = (a1+w1*L_SCD)*b1;
IE_M_RD = (a1+w1*M_SCD)*b1;
IE_H_RD = (a1+w1*H_SCD)*b1;
IE_L_POS = (a2+w2*L_SCD)*b2;
IE_M_POS = (a2+w2*M_SCD)*b2;
IE_H_POS = (a2+w2*H_SCD)*b2;
DIF_LM_RD = IE_L_RD - IE_M_RD;
DIF_LH_RD = IE_L_RD - IE_H_RD;
DIF_MH_RD = IE_M_RD - IE_H_RD;
DIF_LM_POS = IE_L_POS - IE_M_POS;
DIF_LH_POS = IE_L_POS - IE_H_POS;
DIF_MH_POS = IE_M_POS - IE_H_POS;
PLOT(P_L_RD P_M_RD P_H_RD
P_L_POS P_M_POS P_H_POS);
LOOP(XVAL,1,7,0.1);
P_L_RD = IE_L_RD*XVAL;
P_M_RD = IE_M_RD*XVAL;
P_H_RD = IE_H_RD*XVAL;
P_L_POS = IE_L_POS*XVAL;
P_M_POS = IE_M_POS*XVAL;
P_H_POS = IE_H_POS*XVAL;
",
PLOT = "
TYPE = plot2;
",
OUTPUT = "
cint;
STDYX",
rdata = df.raw)
mplusModeler(SEM.mod.SCD, modelout = "./OUTPUT/Mplus/SEM.mod.SCD.inp", run = 1L)
rm(SEM.mod.SCD)
HOFT.EFA <- fa(df.raw[,-c(1:4)], nfactors = 1)
library(here)
# clean data
library(bruceR)
#library(dplyr)
#library(tidyr)
#library(psych)
#library(ggplot2)
library(gridExtra)
# SEM mediation
library(lavaan)
library(lavaanPlot)
# SED moderation
library(MplusAutomation)
library(texreg)
HOFT.EFA <- fa(df.raw[,-c(1:4)], nfactors = 1)
library(psych)
HOFT.EFA <- psych::fa(df.raw[,-c(1:4)], nfactors = 1)
HOFT.EFA$Vaccounted
